<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />

    <title>Storage Smart Contract</title>
  </head>
  <body>
    <div class="container">
      <h1>Storage Smart Contract</h1>
      <button onclick="enableEthereum()" type="button" class="btn btn-success">
        Enable Ethereum
      </button>
    </div>
    <script>
      const ABI = [
        {
          inputs: [],
          name: "retrieve",
          outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
          stateMutability: "view",
          type: "function",
        },
        {
          inputs: [{ internalType: "uint256", name: "num", type: "uint256" }],
          name: "store",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
      ];
      const contractAddress = "0x2de0cFA5B60Db388b96a3a1F62058bcEC5A87151";

      let accounts = [];

      async function enableEthereum() {
        ethereum.request({ method: "eth_requestAccounts" });
        accounts = await web3.eth.getAccounts();
        console.log(accounts);
      }

      const web3 = new Web3(ethereum);
      const contract = new web3.eth.Contract(ABI, contractAddress);

      async function setVal(val) {
        const number = await contract.methods
          .store(val)
          .send({ from: accounts[0] });
        console.log(number);
      }

      async function getVal() {
        const number = await contract.methods.retrieve().call();
        console.log(number);
      }
    </script>
  </body>
</html>
